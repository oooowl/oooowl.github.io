import{c as q}from"./useNestedProp-S1UXxUgm.CErBICdk.js";import{o as ae,L as le,G as oe,k as re,X as se,K as ue,p as D,Q as ie,n as ne,b as ve}from"../chart.md.hi_nZSnT.js";import{x as ce}from"./Title-DYNLqCCT.D6xZGHSM.js";import{s as he,i as ge}from"./usePrinter-8ofTb2MJ.pt_J2AaR.js";import ye from"./vue-ui-skeleton-B2sRnIXX.C3JvNOY7.js";import{p as de}from"./PackageVersion-DtnhR89q.DeJ10Meb.js";import{s as me}from"./vue-data-ui-Cp7bO_tj.DKBrIOIj.js";import{h,p as f,q as H,v as pe,o as i,c as v,b as _,e as b,aj as fe,w as O,r as C,ak as K,al as Q,k as g,n as G,N as U,G as ke,F as Y,C as R,t as be}from"./framework.BaNfDZ-f.js";const $e=["id"],we={key:0,style:"width:100%;background:transparent;padding-bottom:12px"},xe=["xmlns","viewBox"],Ce={key:0},Pe=["d","stroke-width","stroke"],Fe={key:1},Ie=["x1","y1","x2","y2","stroke-width","stroke"],ze=["x","y","font-size","fill","font-weight","text-anchor"],_e={key:3,class:"vue-data-ui-watermark"},Oe={__name:"vue-ui-tiremarks",props:{config:{type:Object,default(){return{}}},dataset:{type:Object,default(){return{}}}},setup(J,{expose:W}){const c=J,{vue_ui_tiremarks:Z}=ae(),I=h(()=>!!c.dataset&&Object.keys(c.dataset).length),z=f(le()),S=f(null),A=f(0),M=f(0),e=h({get:()=>j(),set:t=>t});function j(){const t=q({userConfig:c.config,defaultConfig:Z});return t.theme?{...q({userConfig:oe.vue_ui_tiremarks[t.theme]||c.config,defaultConfig:t})}:t}H(()=>c.config,t=>{e.value=j(),T(),M.value+=1},{deep:!0});const{isPrinting:B,isImaging:N,generatePdf:X,generateImage:E}=he({elementId:z.value,fileName:e.value.style.chart.title.text||"vue-ui-tiremarks"}),s=f(e.value.style.chart.animation.use?0:re(c.dataset.percentage));H(()=>c.dataset,t=>{e.value.style.chart.animation.use?L(t.percentage):s.value=t.percentage||0},{deep:!0}),pe(()=>{T()});function L(t){let a=e.value.style.chart.animation.speed;const l=Math.abs(t-s.value)/(a*120);function r(){s.value<t?s.value=Math.min(s.value+l,t):s.value>t&&(s.value=Math.max(s.value-l,t)),s.value!==t&&requestAnimationFrame(r)}r()}function T(){se(c.dataset)&&ue({componentName:"VueUiTiremarks",type:"dataset"}),L(c.dataset.percentage||0)}const k=h(()=>e.value.style.chart.layout.display==="vertical"),u=h(()=>{const t={top:48,left:64,right:64,bottom:48};return k.value?{top:e.value.style.chart.percentage.verticalPosition==="top"?t.top:3,left:3,right:3,bottom:e.value.style.chart.percentage.verticalPosition==="bottom"?t.bottom:3}:{top:0,bottom:0,left:e.value.style.chart.percentage.horizontalPosition==="left"?t.left:3,right:e.value.style.chart.percentage.horizontalPosition==="right"?t.right:10}}),P=h(()=>Object.values(u.value).reduce((t,a)=>t+a,0)),o=h(()=>({height:k.value?312:56,width:k.value?56:312})),ee=f(100);h(()=>c.dataset.percentage/ee.value);const n=h(()=>k.value?{mark:(o.value.height-P.value)/100*.5,space:(o.value.height-P.value)/100*.5}:{mark:(o.value.width-P.value)/100*.5,space:(o.value.width-P.value)/100*.5}),V=h(()=>{const t=[];for(let a=0;a<100;a+=1){const l=e.value.style.chart.layout.ticks.gradient.show?D(e.value.style.chart.layout.activeColor,a/100*(e.value.style.chart.layout.ticks.gradient.shiftHueIntensity/100)):e.value.style.chart.layout.activeColor;if(k.value){const r=e.value.style.chart.layout.crescendo?(100-a)*(o.value.width-u.value.left-u.value.right)/100/3:0,y=u.value.left+4+r,d=o.value.width-u.value.right-4-r,m=o.value.height-u.value.bottom-a*n.value.mark-a*n.value.space-n.value.mark,p=o.value.height-u.value.bottom-a*n.value.mark-a*n.value.space-n.value.mark,w=(d-y)/e.value.style.chart.layout.curveAngleX,x=e.value.style.chart.layout.curveAngleY*((1+a)/100);t.push({x1:y,x2:d,y1:m,y2:p,curve:`M ${y} ${m} C ${y+w} ${m-x}, ${d-w} ${p-x}, ${d} ${p}`,color:l})}else{const r=e.value.style.chart.layout.crescendo?(100-a)*(o.value.height-u.value.top-u.value.bottom)/100/3:0,y=u.value.left+a*n.value.mark+a*n.value.space-n.value.mark,d=y,m=u.value.top+4+r,p=o.value.height-u.value.bottom-4-r,w=e.value.style.chart.layout.curveAngleY*((1+a)/100),x=(p-m)/e.value.style.chart.layout.curveAngleX;t.push({x1:y,x2:d,y1:m,y2:p,curve:`M ${y} ${m} C ${y+w} ${m+x}, ${d+w} ${p-x}, ${d} ${p}`,color:l})}}return t}),$=h(()=>{let t,a,l;const r=e.value.style.chart.percentage.fontSize/3;return k.value?e.value.style.chart.percentage.verticalPosition==="top"?(t=o.value.width/2,a=u.value.top/2,l="middle"):e.value.style.chart.percentage.verticalPosition==="bottom"&&(t=o.value.width/2,a=o.value.height-u.value.bottom/2+r,l="middle"):e.value.style.chart.percentage.horizontalPosition==="left"?(t=4,a=o.value.height/2+r,l="start"):e.value.style.chart.percentage.horizontalPosition==="right"&&(t=o.value.width-u.value.right+8,a=o.value.height/2+r,l="start"),{x:t,y:a,textAnchor:l,bold:e.value.style.chart.percentage.bold,fontSize:e.value.style.chart.percentage.fontSize,fill:e.value.style.chart.percentage.color}}),F=f(!1);function te(t){F.value=t,A.value+=1}return W({generatePdf:X,generateImage:E}),(t,a)=>(i(),v("div",{ref_key:"tiremarksChart",ref:S,class:G(`vue-ui-tiremarks ${e.value.useCssAnimation?"":"vue-ui-dna"}`),style:U(`font-family:${e.value.style.fontFamily};width:100%; text-align:center;${e.value.style.chart.title.text?"":"padding-top:36px"};background:${e.value.style.chart.backgroundColor}`),id:z.value},[e.value.style.chart.title.text?(i(),v("div",we,[(i(),_(ce,{key:`title_${M.value}`,config:{title:{cy:"wheel-title",...e.value.style.chart.title},subtitle:{cy:"wheel-subtitle",...e.value.style.chart.title.subtitle}}},null,8,["config"]))])):b("",!0),e.value.userOptions.show&&I.value?(i(),_(ge,{ref:"details",key:`user_options_${A.value}`,backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color,isPrinting:g(B),isImaging:g(N),uid:z.value,hasPdf:e.value.userOptions.buttons.pdf,hasImg:e.value.userOptions.buttons.img,hasFullscreen:e.value.userOptions.buttons.fullscreen,hasXls:!1,isFullscreen:F.value,titles:{...e.value.userOptions.buttonTitles},chartElement:S.value,position:e.value.userOptions.position,onToggleFullscreen:te,onGeneratePdf:g(X),onGenerateImage:g(E)},fe({_:2},[t.$slots.optionPdf?{name:"optionPdf",fn:O(()=>[C(t.$slots,"optionPdf",{},void 0,!0)]),key:"0"}:void 0,t.$slots.optionImg?{name:"optionImg",fn:O(()=>[C(t.$slots,"optionImg",{},void 0,!0)]),key:"1"}:void 0,t.$slots.optionFullscreen?{name:"optionFullscreen",fn:O(({toggleFullscreen:l,isFullscreen:r})=>[C(t.$slots,"optionFullscreen",K(Q({toggleFullscreen:l,isFullscreen:r})),void 0,!0)]),key:"2"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasImg","hasFullscreen","isFullscreen","titles","chartElement","position","onGeneratePdf","onGenerateImage"])):b("",!0),I.value?(i(),v("svg",{key:2,xmlns:g(ie),class:G({"vue-data-ui-fullscreen--on":F.value,"vue-data-ui-fulscreen--off":!F.value}),viewBox:`0 0 ${o.value.width} ${o.value.height}`,style:U(`max-width:100%; overflow: visible; background:transparent;color:${e.value.style.chart.color}`)},[ke(de),e.value.style.chart.layout.curved?(i(),v("g",Ce,[(i(!0),v(Y,null,R(V.value,(l,r)=>(i(),v("path",{d:l.curve,"stroke-width":n.value.mark,stroke:s.value>=r?l.color:e.value.style.chart.layout.inactiveColor,"stroke-linecap":"round",fill:"none",class:G({"vue-ui-tick-animated":e.value.style.chart.animation.use&&r<=s.value})},null,10,Pe))),256))])):(i(),v("g",Fe,[(i(!0),v(Y,null,R(V.value,(l,r)=>(i(),v("line",{x1:l.x1,y1:l.y1,x2:l.x2,y2:l.y2,"stroke-width":n.value.mark,stroke:s.value>=r?l.color:e.value.style.chart.layout.inactiveColor,"stroke-linecap":"round"},null,8,Ie))),256))])),e.value.style.chart.percentage.show?(i(),v("text",{key:2,x:$.value.x,y:$.value.y,"font-size":$.value.fontSize,fill:e.value.style.chart.layout.ticks.gradient.show&&e.value.style.chart.percentage.useGradientColor?g(D)(e.value.style.chart.layout.activeColor,s.value/100*(e.value.style.chart.layout.ticks.gradient.shiftHueIntensity/100)):e.value.style.chart.percentage.color,"font-weight":$.value.bold?"bold":"normal","text-anchor":$.value.textAnchor},be(g(ne)(e.value.style.chart.percentage.formatter,s.value,g(ve)({v:s.value,s:"%",r:e.value.style.chart.percentage.rounding}))),9,ze)):b("",!0),C(t.$slots,"svg",{svg:o.value},void 0,!0)],14,xe)):b("",!0),t.$slots.watermark?(i(),v("div",_e,[C(t.$slots,"watermark",K(Q({isPrinting:g(B)||g(N)})),void 0,!0)])):b("",!0),I.value?b("",!0):(i(),_(ye,{key:4,config:{type:"tiremarks",style:{backgroundColor:e.value.style.chart.backgroundColor,tiremarks:{color:"#CCCCCC"}}}},null,8,["config"]))],14,$e))}},Ee=me(Oe,[["__scopeId","data-v-9130298e"]]);export{Ee as default};
