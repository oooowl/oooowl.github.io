import{ar as T,h as x,v as P,p as G,q as J,o as a,c as o,N as _,j as c,a as Z,t as g,k as n,e as h,G as ee,F as p,C as f,n as N,b as V}from"./framework.BaNfDZ-f.js";import{o as le,X as te,K as W,q as ae,L as oe,G as se,c as b,n as q,b as B,Q as ue,p as L}from"../chart.md.hi_nZSnT.js";import{c as H}from"./useNestedProp-S1UXxUgm.CErBICdk.js";import{$ as ie}from"./Shape-CO_Ak9Zm.UkrUmJI7.js";import re from"./vue-ui-skeleton-B2sRnIXX.C3JvNOY7.js";import{p as ne}from"./PackageVersion-DtnhR89q.DeJ10Meb.js";import{s as ve}from"./vue-data-ui-Cp7bO_tj.DKBrIOIj.js";const de={key:0},ye={key:1},ce=["xmlns","viewBox"],pe=["id"],fe=["stop-color"],ge=["stop-color"],he=["id"],be=["stop-color"],me=["stop-color"],xe=["id"],ke=["stop-color"],we=["stop-color"],$e={key:0},_e=["x","y","height","width","fill","stroke","stroke-width","rx"],Ce={key:1},ze=["x","y","font-size","font-weight","fill"],Le=["x","y","font-size","fill"],Se=["x","y","font-size","fill"],Me=["height","width","x","onMouseover","stroke","stroke-width","rx","stroke-dasharray","onClick"],Ae={__name:"vue-ui-sparkhistogram",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},emits:["selectDatapoint"],setup(X,{emit:j}){const v=X;T(t=>({b8c0e060:I.value}));const{vue_ui_sparkhistogram:D}=le(),S=x(()=>!!v.dataset&&v.dataset.length);P(()=>{M()});function M(){te(v.dataset)?W({componentName:"VueUiSparkHistogram",type:"dataset"}):v.dataset.forEach((t,i)=>{ae({datasetObject:t,requiredAttributes:["value"]}).forEach(l=>{W({componentName:"VueUiSparkHistogram",type:"datasetSerieAttribute",property:l,index:i})})})}const m=G(oe()),e=x({get:()=>A(),set:t=>t});function A(){const t=H({userConfig:v.config,defaultConfig:D});return t.theme?{...H({userConfig:se.vue_ui_sparkhistogram[t.theme]||v.config,defaultConfig:t})}:t}J(()=>v.config,t=>{e.value=A(),M()},{deep:!0});const d=x(()=>{const t=e.value.style.layout.height,i=e.value.style.layout.width,l=e.value.style.layout.padding.top,s=t-e.value.style.layout.padding.bottom,y=e.value.style.layout.padding.left,k=i-e.value.style.layout.padding.right,w=l+(t-l-e.value.style.layout.padding.bottom)/2,C=t-e.value.style.layout.padding.top-e.value.style.layout.padding.bottom,$=i-e.value.style.layout.padding.left-e.value.style.layout.padding.right;return{bottom:s,centerY:w,drawingHeight:C,drawingWidth:$,height:t,left:y,right:k,top:l,width:i}}),Y=x(()=>Math.max(...v.dataset.map(t=>Math.abs(t.value||0))));function E(t){return Math.abs(t)/Y.value}const r=x(()=>v.dataset.map((t,i)=>{const l=E(t.value||0),s=d.value.drawingHeight*l,y=d.value.drawingWidth/v.dataset.length,k=y*(e.value.style.bars.gap/100),w=y-k,C=d.value.centerY-s/2,$=d.value.left+(k/2+i*y),O=d.value.left+i*y,z=typeof t.intensity>"u"?100:Math.round(t.intensity*100),R=t.color?t.color:t.value>=0?b(e.value.style.bars.colors.positive,z):b(e.value.style.bars.colors.negative,z),U=t.color?t.color:t.value>=0?e.value.style.bars.colors.positive:e.value.style.bars.colors.negative,K=t.color?`url(#gradient_datapoint_${i}_${m.value})`:t.value>=0?`url(#gradient_positive_${i}_${m.value})`:`url(#gradient_negative_${i}_${m.value})`,Q=$+w/2;return{...t,color:R,gradient:K,height:s,intensity:z,proportion:l,stroke:U,textAnchor:Q,trapX:O,unitWidth:y,width:w,x:$,y:C}})),u=G(null);function F(t,i){j("selectDatapoint",{datapoint:t,index:i})}const I=x(()=>`${e.value.style.animation.speedMs}ms`);return(t,i)=>(a(),o("div",{style:_(`width:100%;background:${e.value.style.backgroundColor};font-family:${e.value.style.fontFamily}`),onMouseleave:i[1]||(i[1]=l=>u.value=null)},[e.value.style.title.text?(a(),o("div",{key:0,style:_(`width:calc(100% - 12px);background:transparent;margin:0 auto;margin:${e.value.style.title.margin};padding: 0 6px;text-align:${e.value.style.title.textAlign}`)},[c("div",{style:_(`font-size:${e.value.style.title.fontSize}px;color:${e.value.style.title.color};font-weight:${e.value.style.title.bold?"bold":"normal"}`)},[Z(g(e.value.style.title.text)+" ",1),u.value!==null?(a(),o("span",de,"- "+g(r.value[u.value].timeLabel||"")+" "+g(n(q)(e.value.style.labels.value.formatter,r.value[u.value].value,n(B)({p:e.value.style.labels.value.prefix,v:r.value[u.value].value,s:e.value.style.labels.value.suffix,r:e.value.style.labels.value.rounding}),{datapoint:r.value[u.value],seriesIndex:u.value})),1)):h("",!0),![void 0,null].includes(u.value)&&![null,void 0].includes(r.value[u.value].valueLabel)?(a(),o("span",ye,"("+g(r.value[u.value].valueLabel||0)+")",1)):h("",!0)],4),e.value.style.title.subtitle.text?(a(),o("div",{key:0,style:_(`font-size:${e.value.style.title.subtitle.fontSize}px;color:${e.value.style.title.subtitle.color};font-weight:${e.value.style.title.subtitle.bold?"bold":"normal"}`)},g(e.value.style.title.subtitle.text),5)):h("",!0)],4)):h("",!0),S.value?(a(),o("svg",{key:1,xmlns:n(ue),viewBox:`0 0 ${d.value.width} ${d.value.height}`,style:{overflow:"visible"}},[ee(ne),c("defs",null,[(a(!0),o(p,null,f(r.value,(l,s)=>(a(),o("radialGradient",{id:`gradient_positive_${s}_${m.value}`,cy:"50%",cx:"50%",r:"50%",fx:"50%",fy:"50%"},[c("stop",{offset:"0%","stop-color":n(b)(n(L)(e.value.style.bars.colors.positive,.05),l.intensity)},null,8,fe),c("stop",{offset:"100%","stop-color":n(b)(e.value.style.bars.colors.positive,l.intensity)},null,8,ge)],8,pe))),256)),(a(!0),o(p,null,f(r.value,(l,s)=>(a(),o("radialGradient",{id:`gradient_negative_${s}_${m.value}`,cy:"50%",cx:"50%",r:"50%",fx:"50%",fy:"50%"},[c("stop",{offset:"0%","stop-color":n(b)(n(L)(e.value.style.bars.colors.negative,.05),l.intensity)},null,8,be),c("stop",{offset:"100%","stop-color":n(b)(e.value.style.bars.colors.negative,l.intensity)},null,8,me)],8,he))),256)),(a(!0),o(p,null,f(r.value,(l,s)=>(a(),o("radialGradient",{id:`gradient_datapoint_${s}_${m.value}`,cy:"50%",cx:"50%",r:"50%",fx:"50%",fy:"50%"},[c("stop",{offset:"0%","stop-color":n(b)(n(L)(l.color,.05),l.intensity)},null,8,ke),c("stop",{offset:"100%","stop-color":n(b)(l.color,l.intensity)},null,8,we)],8,xe))),256))]),!e.value.style.bars.shape||e.value.style.bars.shape==="square"?(a(),o("g",$e,[(a(!0),o(p,null,f(r.value,(l,s)=>(a(),o("rect",{x:l.x,y:l.y,height:l.height,width:l.width,fill:e.value.style.bars.colors.gradient.show?l.gradient:l.color,stroke:l.stroke,"stroke-width":e.value.style.bars.strokeWidth,rx:`${e.value.style.bars.borderRadius*l.proportion/12}%`,class:N({"vue-ui-sparkhistogram-shape":e.value.style.animation.show})},null,10,_e))),256))])):(a(),o("g",Ce,[(a(!0),o(p,null,f(r.value,(l,s)=>(a(),V(ie,{plot:{x:l.x+l.width/2,y:l.y+l.height/2},color:e.value.style.bars.colors.gradient.show?l.gradient:l.color,shape:e.value.style.bars.shape,radius:l.height*.4,class:N({"vue-ui-sparkhistogram-shape":e.value.style.animation.show})},null,8,["plot","color","shape","radius","class"]))),256))])),(a(!0),o(p,null,f(r.value,(l,s)=>(a(),o("text",{"text-anchor":"middle",x:l.textAnchor,y:l.y-e.value.style.labels.value.fontSize/3+e.value.style.labels.value.offsetY,"font-size":e.value.style.labels.value.fontSize,"font-weight":e.value.style.labels.value.bold?"bold":"normal",fill:e.value.style.labels.value.color},g(n(q)(e.value.style.labels.value.formatter,l.value,n(B)({p:e.value.style.labels.value.prefix,v:l.value,s:e.value.style.labels.value.suffix,r:e.value.style.labels.value.rounding}),{datapoint:r.value[u.value],seriesIndex:u.value})),9,ze))),256)),(a(!0),o(p,null,f(r.value,(l,s)=>(a(),o("g",null,[l.valueLabel?(a(),o("text",{key:0,x:l.textAnchor,y:l.y+l.height+e.value.style.labels.valueLabel.fontSize,"font-size":e.value.style.labels.valueLabel.fontSize,"text-anchor":"middle",fill:e.value.style.labels.valueLabel.color},g(l.valueLabel),9,Le)):h("",!0)]))),256)),(a(!0),o(p,null,f(r.value,(l,s)=>(a(),o("g",null,[l.timeLabel?(a(),o("text",{key:0,x:l.textAnchor,y:d.value.height-e.value.style.labels.timeLabel.fontSize/2,"font-size":e.value.style.labels.timeLabel.fontSize,fill:e.value.style.labels.timeLabel.color,"text-anchor":"middle"},g(l.timeLabel),9,Se)):h("",!0)]))),256)),(a(!0),o(p,null,f(r.value,(l,s)=>(a(),o("g",null,[c("rect",{height:d.value.height,width:l.unitWidth,fill:"transparent",x:l.trapX,y:0,onMouseover:y=>u.value=s,onMouseleave:i[0]||(i[0]=y=>u.value=null),stroke:u.value!==null&&u.value===s?e.value.style.selector.stroke:"","stroke-width":u.value!==null&&u.value===s?e.value.style.selector.strokeWidth:0,rx:e.value.style.selector.borderRadius,"stroke-dasharray":e.value.style.selector.strokeDasharray,onClick:()=>F(l,s)},null,40,Me)]))),256))],8,ce)):h("",!0),S.value?h("",!0):(a(),V(re,{key:2,config:{type:"sparkHistogram",style:{backgroundColor:e.value.style.backgroundColor,sparkHistogram:{color:"#CCCCCC"}}}},null,8,["config"]))],36))}},Xe=ve(Ae,[["__scopeId","data-v-eff7ec8f"]]);export{Xe as default};
