import{o as ue,X as ne,K as E,q as ie,L as he,M as ve,I as ce,j as ge,n as x,b as w,Q as de,G as me}from"../chart.md.hi_nZSnT.js";import{c as R}from"./useNestedProp-S1UXxUgm.CErBICdk.js";import{x as ye}from"./Title-DYNLqCCT.D6xZGHSM.js";import{C as fe}from"./Legend-DXLiSLHd.5wpQgPWV.js";import{s as pe,i as be}from"./usePrinter-8ofTb2MJ.pt_J2AaR.js";import{p as ke}from"./PackageVersion-DtnhR89q.DeJ10Meb.js";import{s as xe}from"./vue-data-ui-Cp7bO_tj.DKBrIOIj.js";import{p as g,h as d,v as we,q as U,Y as Le,o as r,c as u,b as I,e as h,aj as $e,w as L,r as y,ak as V,al as q,k as v,n as K,N as Q,G as Be,F as P,C as _,j as b,t as $}from"./framework.BaNfDZ-f.js";import"./Shape-CO_Ak9Zm.UkrUmJI7.js";const Fe=["id"],Ce=["xmlns","viewBox"],Ie={key:0},Pe=["x","y","height","width","fill","stroke"],_e=["x","y","height","width","rx","fill","stroke","stroke-width"],ze=["x","y","height","width","fill","stroke","stroke-width"],He=["x","y","font-size","font-weight","fill"],Se=["x","y","height","width","rx","fill","stroke","stroke-width"],Me={key:3},We=["x","y","fill","font-size","font-weight"],Oe={key:4},Ne=["x1","x2","y1","y2","stroke"],Te={key:3,class:"vue-data-ui-watermark"},Ae={class:"vue-ui-bullet-legend-item",dir:"auto"},Ge={style:{"margin-right":"2px"}},je={__name:"vue-ui-bullet",props:{config:{type:Object,default(){return{}}},dataset:{type:Object,default(){return{}}}},setup(X,{expose:Y}){const o=X,{vue_ui_bullet:D}=ue(),z=g(null),J=g(null),H=g(0),Z=g(null),ee=g(0),B=d({get:()=>!0,set:t=>t}),f=d(()=>o.dataset.segments?Array.isArray(o.dataset.segments)?o.dataset.segments.length?!0:(console.warn(`VueUiBullet: dataset segments is empty. Provide segments with this datastructure:

segments: [
    {
        name: string;
        from: number;
        to: number;
        color?: string;
    },
    {...}
]
        `),!1):(console.warn(`VueUiBullet: dataset segments must be an array of objects with this datastructure:

segments: [
    {
        name: string;
        from: number;
        to: number;
        color?: string;
    },
    {...}
] 
        `),!1):!1);we(S);function S(){ne(o.dataset)?E({componentName:"VueUiBullet",type:"dataset"}):f.value&&o.dataset.segments.forEach((t,s)=>{ie({datasetObject:t,requiredAttributes:["name","from","to"]}).forEach(l=>{B.value=!1,E({componentName:"VueUiBullet segment",type:"datasetSerieAttribute",property:l,index:s})})}),e.value.style.chart.animation.show&&O(o.dataset.value||0)}const F=g(he());function M(){const t=R({userConfig:o.config,defaultConfig:D});return t.theme?{...R({userConfig:me.vue_ui_bullet[t.theme]||o.config,defaultConfig:t})}:t}const e=d({get:()=>M(),set:t=>t});U(()=>o.config,t=>{e.value=M(),S(),H.value+=1},{deep:!0});const a=d(()=>{const t=e.value.style.chart.height,s=e.value.style.chart.width,l=e.value.style.chart.padding.left,m=s-e.value.style.chart.padding.right,k=e.value.style.chart.padding.top,i=t-e.value.style.chart.padding.bottom;return{height:t,width:s,left:l,right:m,top:k,bottom:i,chartWidth:m-l,chartHeight:i-k}}),te=d(()=>{if(!f.value)return[];const t=[];for(let s=0;s<o.dataset.segments.length;s+=1)t.push(ve(e.value.style.chart.segments.baseColor,s/o.dataset.segments.length));return t}),C=d(()=>f.value?{min:Math.min(...o.dataset.segments.map(t=>t.from)),max:Math.max(...o.dataset.segments.map(t=>t.to))}:{min:0,max:1}),n=g(ae());U(()=>o.dataset,t=>{e.value.style.chart.animation.show?O(t.value||0):n.value=t.value||0},{deep:!0});function ae(){return e.value.style.chart.animation.show?C.value.min:o.dataset.value||0}const W=g(null);function O(t){const s=Math.abs(t-n.value)/e.value.style.chart.animation.animationFrames;function l(){n.value<t?n.value=Math.min(n.value+s,t):n.value>t&&(n.value=Math.max(n.value-s,t)),n.value!==t&&(W.value=requestAnimationFrame(l))}l()}Le(()=>{cancelAnimationFrame(W.value)});const c=d(()=>{if(!f.value)return[];const t=ce(C.value.min,C.value.max,e.value.style.chart.segments.ticks.divisions),s=t.min>=0?0:Math.abs(t.min),l={x:a.value.left+(o.dataset.target+s)/(t.max+s)*a.value.chartWidth-e.value.style.chart.target.width/2},m={width:(n.value+s)/(t.max+s)*a.value.chartWidth},k=t.ticks.map(i=>({value:i,y:a.value.bottom+e.value.style.chart.segments.dataLabels.fontSize+3+e.value.style.chart.segments.dataLabels.offsetY,x:a.value.left+(i+s)/(t.max+s)*a.value.chartWidth}));return{scale:t,target:l,value:m,ticks:k,chunks:o.dataset.segments.map((i,oe)=>({...i,color:i.color?ge(i.color):te.value[oe],x:a.value.left+a.value.chartWidth*((i.from+s)/(t.max+s)),y:a.value.top,height:a.value.chartHeight,width:a.value.chartWidth*(Math.abs(i.to-i.from)/(t.max+s))}))}}),N=d(()=>c.value.chunks.map(t=>{const s=x(e.value.style.chart.segments.dataLabels.formatter,t.from,w({p:e.value.style.chart.segments.dataLabels.prefix,v:t.from,s:e.value.style.chart.segments.dataLabels.suffix,r:e.value.style.chart.segments.dataLabels.rounding})),l=x(e.value.style.chart.segments.dataLabels.formatter,t.to,w({p:e.value.style.chart.segments.dataLabels.prefix,v:t.to,s:e.value.style.chart.segments.dataLabels.suffix,r:e.value.style.chart.segments.dataLabels.rounding}));return{...t,shape:"square",value:`${s} - ${l}`}})),le=d(()=>({cy:"bullet-div-legend",backgroundColor:"transparent",color:e.value.style.chart.legend.color,fontSize:e.value.style.chart.legend.fontSize,paddingBottom:6,fontWeight:e.value.style.chart.legend.bold?"bold":""})),{isPrinting:T,isImaging:A,generatePdf:G,generateImage:j}=pe({elementId:`bullet_${F.value}`,fileName:e.value.style.chart.title.text||"vue-ui-bullet"}),p=g(!1);function se(t){p.value=t,ee.value+=1}function re(){return c.value}return Y({generatePdf:G,generateImage:j,getData:re}),(t,s)=>(r(),u("div",{ref_key:"bulletChart",ref:z,class:K(`vue-ui-bullet ${p.value?"vue-data-ui-wrapper-fullscreen":""}`),style:Q(`font-family:${e.value.style.fontFamily};width:100%;background:${e.value.style.chart.backgroundColor}`),id:`bullet_${F.value}`},[e.value.style.chart.title.text?(r(),u("div",{key:0,ref_key:"chartTitle",ref:J,style:"width:100%;background:transparent;"},[(r(),I(ye,{lineHeight:"1.3rem",key:`title_${H.value}`,config:{title:{cy:"bullet-div-title",...e.value.style.chart.title},subtitle:{cy:"bullet-div-subtitle",...e.value.style.chart.title.subtitle}}},null,8,["config"]))],512)):h("",!0),e.value.userOptions.show&&B.value?(r(),I(be,{key:1,ref:"details",backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color,isPrinting:v(T),isImaging:v(A),uid:F.value,hasTooltip:!1,hasPdf:e.value.userOptions.buttons.pdf,hasImg:e.value.userOptions.buttons.img,hasXls:!1,hasTable:!1,hasLabel:!1,hasFullscreen:e.value.userOptions.buttons.fullscreen,isFullscreen:p.value,chartElement:z.value,position:e.value.userOptions.position,titles:{...e.value.userOptions.buttonTitles},onToggleFullscreen:se,onGeneratePdf:v(G),onGenerateImage:v(j)},$e({_:2},[t.$slots.optionPdf?{name:"optionPdf",fn:L(()=>[y(t.$slots,"optionPdf",{},void 0,!0)]),key:"0"}:void 0,t.$slots.optionImg?{name:"optionImg",fn:L(()=>[y(t.$slots,"optionImg",{},void 0,!0)]),key:"1"}:void 0,t.$slots.optionFullscreen?{name:"optionFullscreen",fn:L(({toggleFullscreen:l,isFullscreen:m})=>[y(t.$slots,"optionFullscreen",V(q({toggleFullscreen:l,isFullscreen:m})),void 0,!0)]),key:"2"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasImg","hasFullscreen","isFullscreen","chartElement","position","titles","onGeneratePdf","onGenerateImage"])):h("",!0),B.value?(r(),u("svg",{key:2,xmlns:v(de),class:K({"vue-data-ui-fullscreen--on":p.value,"vue-data-ui-fulscreen--off":!p.value,"vue-ui-bullet-svg":!0}),viewBox:`0 0 ${a.value.width} ${a.value.height}`,style:Q(`width: 100%; overflow: visible; background:transparent;color:${e.value.style.chart.color}`)},[Be(ke),f.value?(r(),u("g",Ie,[(r(!0),u(P,null,_(c.value.chunks,l=>(r(),u("rect",{x:l.x,y:l.y,height:l.height,width:l.width,fill:l.color,"stroke-width":1,stroke:e.value.style.chart.backgroundColor},null,8,Pe))),256)),e.value.style.chart.target.onTop?h("",!0):(r(),u("rect",{key:0,x:c.value.target.x,y:a.value.top+(a.value.chartHeight-a.value.chartHeight*e.value.style.chart.target.heightRatio)/2,height:a.value.chartHeight*e.value.style.chart.target.heightRatio,width:e.value.style.chart.target.width,rx:e.value.style.chart.target.rounded?e.value.style.chart.target.width/2:0,fill:e.value.style.chart.target.color,stroke:e.value.style.chart.target.stroke,"stroke-width":e.value.style.chart.target.strokeWidth},null,8,_e)),b("rect",{x:a.value.left,y:a.value.top+(a.value.chartHeight-a.value.chartHeight*e.value.style.chart.valueBar.heightRatio)/2,height:a.value.chartHeight*e.value.style.chart.valueBar.heightRatio,width:c.value.value.width,fill:e.value.style.chart.valueBar.color,stroke:e.value.style.chart.valueBar.stroke,"stroke-width":e.value.style.chart.valueBar.strokeWidth},null,8,ze),e.value.style.chart.valueBar.label.show?(r(),u("text",{key:1,x:a.value.left+c.value.value.width,y:a.value.top-6+e.value.style.chart.valueBar.label.offsetY,"font-size":e.value.style.chart.valueBar.label.fontSize,"font-weight":e.value.style.chart.valueBar.label.bold?"bold":"normal",fill:e.value.style.chart.valueBar.label.color,"text-anchor":"middle"},$(v(x)(e.value.style.chart.segments.dataLabels.formatter,n.value,v(w)({p:e.value.style.chart.segments.dataLabels.prefix,v:n.value,s:e.value.style.chart.segments.dataLabels.suffix,r:e.value.style.chart.segments.dataLabels.rounding}))),9,He)):h("",!0),e.value.style.chart.target.onTop?(r(),u("rect",{key:2,x:c.value.target.x,y:a.value.top+(a.value.chartHeight-a.value.chartHeight*e.value.style.chart.target.heightRatio)/2,height:a.value.chartHeight*e.value.style.chart.target.heightRatio,width:e.value.style.chart.target.width,rx:e.value.style.chart.target.rounded?e.value.style.chart.target.width/2:0,fill:e.value.style.chart.target.color,stroke:e.value.style.chart.target.stroke,"stroke-width":e.value.style.chart.target.strokeWidth},null,8,Se)):h("",!0),e.value.style.chart.segments.dataLabels.show?(r(),u("g",Me,[(r(!0),u(P,null,_(c.value.ticks,l=>(r(),u("text",{x:l.x,y:l.y,"text-anchor":"middle",fill:e.value.style.chart.segments.dataLabels.color,"font-size":e.value.style.chart.segments.dataLabels.fontSize+"px","font-weight":e.value.style.chart.segments.dataLabels.bold?"bold":"normal"},$(v(x)(e.value.style.chart.segments.dataLabels.formatter,l.value,v(w)({p:e.value.style.chart.segments.dataLabels.prefix,v:l.value,s:e.value.style.chart.segments.dataLabels.suffix,r:e.value.style.chart.segments.dataLabels.rounding}))),9,We))),256))])):h("",!0),e.value.style.chart.segments.dataLabels.show&&e.value.style.chart.segments.ticks.show?(r(),u("g",Oe,[(r(!0),u(P,null,_(c.value.ticks,l=>(r(),u("line",{x1:l.x,x2:l.x,y1:a.value.bottom,y2:a.value.bottom+3,stroke:e.value.style.chart.segments.ticks.stroke,"stroke-width":1,"stroke-linecap":"round"},null,8,Ne))),256))])):h("",!0)])):h("",!0),y(t.$slots,"svg",{svg:a.value},void 0,!0)],14,Ce)):h("",!0),t.$slots.watermark?(r(),u("div",Te,[y(t.$slots,"watermark",V(q({isPrinting:v(T)||v(A)})),void 0,!0)])):h("",!0),b("div",{ref_key:"chartLegend",ref:Z},[e.value.style.chart.legend.show?(r(),I(fe,{key:0,clickable:!1,legendSet:N.value,config:le.value},{item:L(({legend:l})=>[b("div",Ae,[b("span",Ge,$(l.name)+":",1),b("span",null,$(l.value),1)])]),_:1},8,["legendSet","config"])):h("",!0),y(t.$slots,"legend",{legend:N.value},void 0,!0)],512)],14,Fe))}},De=xe(je,[["__scopeId","data-v-8f9b47b1"]]);export{De as default};
