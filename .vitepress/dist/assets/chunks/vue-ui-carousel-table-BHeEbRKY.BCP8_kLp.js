import{o as Ae,L as ke,X as H,K as M,c as we,N as Te,O as Ie}from"../chart.md.hi_nZSnT.js";import{c as Fe}from"./useNestedProp-S1UXxUgm.CErBICdk.js";import{s as _e,i as Be}from"./usePrinter-8ofTb2MJ.pt_J2AaR.js";import ze from"./vue-ui-skeleton-B2sRnIXX.C3JvNOY7.js";import{s as Pe}from"./vue-data-ui-Cp7bO_tj.DKBrIOIj.js";import{p as a,v as F,h as _,q as V,Y as re,P as de,o as u,c as r,j as R,N as d,a as X,t as q,r as p,F as j,C as G,ak as U,al as K,k as x,e as N,n as Oe,b as ve,aj as Re,w as B}from"./framework.BaNfDZ-f.js";import"./PackageVersion-DtnhR89q.DeJ10Meb.js";const Ne=["id"],Se=["height"],Le=["data-cell","height"],Ee={__name:"vue-ui-carousel-table",props:{config:{type:Object,default(){return{}}},dataset:{type:Object,default(){return{}}}},setup(m,{expose:ce}){const n=m,{vue_ui_carousel_table:pe}=Ae(),S=a(ke()),Y=a(!1),$=a(!!n.dataset);F(()=>{D()});function D(){H(n.dataset)?M({componentName:"VueUiCarouselTable",type:"dataset"}):((!n.dataset.head||H(n.dataset.head))&&(M({componentName:"VueUiCarouselTable",type:"datasetAttribute",property:"head"}),$.value=!1),(!n.dataset.body||H(n.dataset.body))&&(M({componentName:"VueUiCarouselTable",type:"datasetAttribute",property:"body"}),$.value=!1))}const e=_({get:()=>Q(),set:t=>t});function Q(){return Fe({userConfig:n.config,defaultConfig:pe})}V(()=>n.config,t=>{e.value=Q(),D()},{deep:!0}),V(()=>n.dataset,t=>{L()},{deep:!0});const{isPrinting:W,isImaging:Z,generatePdf:he,generateImage:J}=_e({elementId:`carousel-table_${S.value}`,fileName:e.value.caption.text||"vue-ui-carousel-table"}),v=a({showAnimation:e.value.animation.use}),s=a(null),ee=a(null),C=a(null),A=a(null),k=a(0),z=a(0),P=a(!1),w=a(null),h=a(null),T=a(0);function L(){w.value&&(h.value={elements:w.value.getElementsByTagName("tr"),heights:Array.from(w.value.getElementsByTagName("tr")).map(t=>t.getBoundingClientRect().height)})}F(L);const ge=_(()=>!h.value||!h.value.heights.length?0:Math.max(...h.value.heights)+k.value+z.value),me=_(()=>n.dataset.body?e.value.tbody.tr.visible<=n.dataset.body.length?e.value.tbody.tr.visible:n.dataset.body.length:0),be=_(()=>(e.value.tbody.tr.height+e.value.tbody.tr.td.padding.top+e.value.tbody.tr.td.padding.bottom+e.value.tbody.tr.border.size*2)*me.value+k.value+z.value),O=a(0),I=a(null),b=a(0),y=a(!1),te=a(0);F(()=>{C.value&&(k.value=C.value.getBoundingClientRect().height),A.value&&(z.value=A.value.getBoundingClientRect().height),v.value.showAnimation&&h.value&&ae()}),F(()=>{if(s.value){let t=function(){const i=l.getBoundingClientRect().bottom;o.forEach(c=>{c.getBoundingClientRect().top<i?c.style.visibility="hidden":c.style.visibility="visible"})};const l=s.value.querySelector("thead"),o=Array.from(w.value.querySelectorAll("tr"));s.value.addEventListener("scroll",t),t(),re(()=>{s.value.removeEventListener("scroll",t)})}});function ye(t){Y.value=t,te.value+=1}function ae(){!I.value&&!y.value&&(I.value=requestAnimationFrame(oe))}function fe(){if(!s.value)return!1;const{scrollTop:t,scrollHeight:l,clientHeight:o}=s.value;return t+o>=l}function oe(t){y.value||(b.value||(b.value=t),t-b.value>=e.value.animation.speedMs&&(O.value+=h.value.heights[T.value],(fe()||T.value>=h.value.heights.length)&&(O.value=0,T.value=-1),T.value+=1,s.value&&s.value.scrollTo({top:O.value,behavior:"smooth"}),b.value=t),I.value=requestAnimationFrame(oe))}function g(){y.value=!0,cancelAnimationFrame(I.value),I.value=null}re(g);function f(){!y.value||!v.value.showAnimation||(y.value=!1,b.value=0,ae())}function xe(){e.value.animation.pauseOnHover&&g()}const E=a(null);function $e(){g(),clearTimeout(E.value)}function le(){clearTimeout(E.value),E.value=setTimeout(f,1e3)}V(()=>e.value.animation.use,t=>{t?(v.value.showAnimation=!0,f()):(v.value.showAnimation=!1,g())});const Ce=_(()=>e.value.responsiveBreakpoint);F(()=>{const t=new ResizeObserver(l=>{l.forEach(o=>{P.value=o.contentRect.width<Ce.value}),k.value=C.value?C.value.getBoundingClientRect().height:0,z.value=A.value?A.value.getBoundingClientRect().height:0,T.value=0,de(()=>{g(),b.value=0,O.value=0,L(),f()})});s.value&&t.observe(s.value)});function ne(){he()}function ie(){v.value.showAnimation=!v.value.showAnimation,v.value.showAnimation?f():g()}function se(){de(()=>{const t=n.dataset.head.map((i,c)=>[[n.dataset.body[c]]]),l=[[e.value.caption.text],[n.dataset.head.map(i=>[i])]].concat(t),o=Te(l);Ie({csvContent:o,title:e.value.caption.text||"vue-ui-carousel-table"})})}return ce({pauseAnimation:g,resumeAnimation:f,toggleAnimation:ie,generateCsv:se,generatePdf:ne,generateImage:J}),(t,l)=>(u(),r("div",{style:{position:"relative",overflow:"visible"},ref_key:"chartContainer",ref:ee},[R("div",{ref_key:"tableContainer",ref:s,id:`carousel-table_${S.value}`,style:d({height:x(W)||x(Z)?"auto":`${Math.max(be.value,ge.value)}px`,containerType:"inline-size",position:"relative",overflow:"auto",fontFamily:e.value.fontFamily}),class:Oe({"vue-ui-responsive":P.value,"is-playing":!y.value}),onMouseover:l[0]||(l[0]=o=>xe()),onMouseleave:l[1]||(l[1]=o=>f()),onTouchstart:l[2]||(l[2]=o=>$e()),onTouchend:l[3]||(l[3]=o=>le()),onTouchcancel:l[4]||(l[4]=o=>le())},[$.value?(u(),r("table",{key:0,class:"vue-data-ui-carousel-table",style:d({...e.value.style,border:`${e.value.border.size}px solid ${e.value.border.color}`,width:"100%",borderCollapse:"collapse"})},[R("caption",{ref_key:"caption",ref:C,class:"vue-data-ui-carousel-table-caption",style:d({...e.value.caption.style,fontFamily:"inherit",position:"sticky",top:0,zIndex:2,paddingTop:e.value.caption.padding.top+"px",paddingRight:e.value.caption.padding.right+"px",paddingBottom:e.value.caption.padding.bottom+"px",paddingLeft:e.value.caption.padding.left+"px",boxShadow:P.value?e.value.thead.tr.style.boxShadow:"none",minHeight:"36px"})},[X(q(e.value.caption.text&&!t.$slots.caption?e.value.caption.text:"")+" ",1),p(t.$slots,"caption",{},void 0,!0)],4),R("thead",{style:d({...e.value.thead.style,position:"sticky",top:`${k.value}px`,zIndex:1})},[R("tr",{ref_key:"tableRow",ref:A,role:"row",style:d({...e.value.thead.tr.style,border:e.value.thead.tr.border.size?`${e.value.thead.tr.border.size}px solid ${e.value.thead.tr.border.color}`:"none",boxShadow:P.value?"none":e.value.thead.tr.style.boxShadow}),height:`${e.value.thead.tr.height}px`},[(u(!0),r(j,null,G(m.dataset.head,(o,i)=>(u(),r("th",{role:"cell",key:`th_${i}`,style:d({...e.value.thead.tr.th.style,border:e.value.thead.tr.th.border.size?`${e.value.thead.tr.th.border.size}px solid ${e.value.thead.tr.th.border.color}`:"none",paddingTop:e.value.thead.tr.th.padding.top+"px",paddingRight:e.value.thead.tr.th.padding.right+"px",paddingBottom:e.value.thead.tr.th.padding.bottom+"px",paddingLeft:e.value.thead.tr.th.padding.left+"px"})},[X(q(t.$slots.th?"":o)+" ",1),p(t.$slots,"th",U(K({th:o,colIndex:i})),void 0,!0)],4))),128))],12,Se)],4),m.dataset.body&&m.dataset.head?(u(),r("tbody",{key:0,ref_key:"tbody",ref:w,style:d({clipPath:"inset(0,0,0,0)"})},[(u(!0),r(j,null,G(m.dataset.body,(o,i)=>(u(),r("tr",{style:d({...e.value.tbody.tr.style,border:`${e.value.tbody.tr.border.size}px solid ${e.value.tbody.tr.border.color}`,verticalAlign:"middle"})},[(u(!0),r(j,null,G(o,(c,ue)=>(u(),r("td",{role:"cell","data-cell":m.dataset.head[ue]||"",style:d({...e.value.tbody.tr.td.style,border:`${e.value.tbody.tr.td.border.size}px solid ${e.value.tbody.tr.td.border.color}`,backgroundColor:x(we)(e.value.tbody.tr.td.style.backgroundColor,i%2===0&&e.value.tbody.tr.td.alternateColor?e.value.tbody.tr.td.alternateOpacity*100:100),paddingTop:e.value.tbody.tr.td.padding.top+"px",paddingRight:e.value.tbody.tr.td.padding.right+"px",paddingBottom:e.value.tbody.tr.td.padding.bottom+"px",paddingLeft:e.value.tbody.tr.td.padding.left+"px",verticalAlign:"middle"}),height:`${e.value.tbody.tr.height}px`},[X(q(t.$slots.td?"":c)+" ",1),p(t.$slots,"td",U(K({td:c,rowIndex:i,colIndex:ue})),void 0,!0)],12,Le))),256))],4))),256))],4)):N("",!0)],4)):N("",!0)],46,Ne),$.value?N("",!0):(u(),ve(ze,{key:0,config:{type:"table"}})),e.value.userOptions.show&&$.value?(u(),ve(Be,{ref:"details",key:`user_option_${te.value}`,backgroundColor:e.value.style.backgroundColor,color:e.value.style.color,isPrinting:x(W),isImaging:x(Z),uid:S.value,hasTooltip:!1,hasPdf:e.value.userOptions.buttons.pdf,hasImg:e.value.userOptions.buttons.img,hasXls:e.value.userOptions.buttons.csv,hasTable:!1,hasLabel:!1,hasAnimation:e.value.userOptions.buttons.animation,isAnimation:!v.value.showAnimation,hasFullscreen:e.value.userOptions.buttons.fullscreen,isFullscreen:Y.value,chartElement:ee.value,position:e.value.userOptions.position,titles:{...e.value.userOptions.buttonTitles},zIndex:3,offsetX:12,onGeneratePdf:ne,onGenerateCsv:se,onGenerateImage:x(J),onToggleAnimation:ie,onToggleFullscreen:ye},Re({_:2},[t.$slots.optionPdf?{name:"optionPdf",fn:B(()=>[p(t.$slots,"optionPdf",{},void 0,!0)]),key:"0"}:void 0,t.$slots.optionCsv?{name:"optionCsv",fn:B(()=>[p(t.$slots,"optionCsv",{},void 0,!0)]),key:"1"}:void 0,t.$slots.optionImg?{name:"optionImg",fn:B(()=>[p(t.$slots,"optionImg",{},void 0,!0)]),key:"2"}:void 0,t.$slots.optionAnimation?{name:"optionAnimation",fn:B(()=>[p(t.$slots,"optionAnimation",{},void 0,!0)]),key:"3"}:void 0,t.$slots.optionFullscreen?{name:"optionFullscreen",fn:B(({toggleFullscreen:o,isFullscreen:i})=>[p(t.$slots,"optionFullscreen",U(K({toggleFullscreen:o,isFullscreen:i})),void 0,!0)]),key:"4"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasImg","hasXls","hasAnimation","isAnimation","hasFullscreen","isFullscreen","chartElement","position","titles","onGenerateImage"])):N("",!0)],512))}},Ue=Pe(Ee,[["__scopeId","data-v-9f07c041"]]);export{Ue as default};
