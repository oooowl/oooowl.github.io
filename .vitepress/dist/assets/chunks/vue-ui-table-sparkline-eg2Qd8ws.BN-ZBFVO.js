import{ar as ve,p as v,h as m,q as K,v as de,o as s,c as d,j as c,N as i,t as p,e as f,F as O,C as G,n as M,b as T,aj as ce,w as I,r as A,ak as pe,al as be,k as r,P as ge}from"./framework.BaNfDZ-f.js";import{o as me,L as fe,G as ye,R as he,e as $,a as xe,X as ke,K as J,q as _e,j as Ce,_ as we,n as S,b as z,N as Ie,O as Ae}from"../chart.md.hi_nZSnT.js";import{c as Y}from"./useNestedProp-S1UXxUgm.CErBICdk.js";import $e from"./vue-ui-sparkline-DGJDBArr.CLWc7JoS.js";import{s as Se,u as ze}from"./vue-data-ui-Cp7bO_tj.DKBrIOIj.js";import{s as Pe,i as Fe}from"./usePrinter-8ofTb2MJ.pt_J2AaR.js";import"./vue-ui-skeleton-B2sRnIXX.C3JvNOY7.js";import"./PackageVersion-DtnhR89q.DeJ10Meb.js";import"./useResponsive-NZB-WLRF.DbXjWqi_.js";const Ne=["id"],We={style:{"z-index":"1","padding-right":"24px"}},Oe=["onClick"],Ge={style:{display:"flex","flex-direction":"row",gap:"3px","align-items":"center"}},Me=["data-cell"],Te={dir:"auto",style:{display:"flex","flex-direction":"row","align-items":"center",gap:"6px"}},Ee=["data-cell","onPointerenter"],Re=["data-cell"],Be=["data-cell"],Ve=["data-cell"],je=["data-cell"],qe={__name:"vue-ui-table-sparkline",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},setup(Z,{expose:Q}){const b=Z;ve(a=>({"6ca111be":a.tdo}));const{vue_ui_table_sparkline:ee}=me(),P=v(fe()),E=v(0),_=v(0),e=m({get:()=>R(),set:a=>a});function R(){const a=Y({userConfig:b.config,defaultConfig:ee});return a.theme?{...Y({userConfig:ye.vue_ui_table_sparkline[a.theme]||b.config,defaultConfig:a}),customPalette:he[a.theme]||$}:a}K(()=>b.config,a=>{e.value=R(),X(),_.value+=1},{deep:!0}),K(()=>b.dataset,a=>{k.value=y.value,_.value+=1},{deep:!0});const{isPrinting:B,isImaging:V,generatePdf:j,generateImage:q}=Pe({elementId:`table_${P.value}`,fileName:e.value.title.text||"vue-ui-table-sparkline"}),ae=m(()=>xe(e.value.customPalette)),C=v(null),L=v(!1),te=m(()=>e.value.responsiveBreakpoint);de(()=>{X()});function X(){ke(b.dataset)&&J({componentName:"VueUiTableSparkline",type:"dataset"});const a=new ResizeObserver(n=>{n.forEach(t=>{L.value=t.contentRect.width<te.value})});C.value&&a.observe(C.value)}const D=m(()=>(b.dataset.forEach((a,n)=>{_e({datasetObject:a,requiredAttributes:["name","values"]}).forEach(t=>{J({componentName:"VueUiTableSparkline",type:"datasetSerieAttribute",property:t,index:n})})}),b.dataset.map((a,n)=>{const t=(a.values||[]).map(o=>isNaN(o)?0:o??0),l=t.reduce((o,u)=>o+u,0);return{...a,values:a.values||[],color:Ce(a.color)||ae.value[n]||$[n]||$[n%$.length],sum:l,average:l/t.length,median:we(t),sparklineDataset:t.map((o,u)=>({period:e.value.colNames[u]||`col ${u}`,value:o||0}))}})));function le(a){const n=(a[0].values||[]).map((t,l)=>a.map(o=>o.values[l]||[])).map(t=>t.map((l,o)=>[l,o]).sort((l,o)=>o[0]-l[0]).map(l=>l[1]));return a.map((t,l)=>({...t,values:t.values||[],orders:n[l]}))}const y=m(()=>le(D.value)),k=v(y.value),oe=m(()=>Math.max(...k.value.map(a=>(a.values||[]).length))),w=v(void 0),F=v(!1),N=v(void 0),W=v(-1);function ne(){F.value=!1,N.value=void 0,W.value=-1,k.value=y.value}function ue(a){F.value=!0,N.value=a;const n=y.value.map(o=>o.values[a]||[]),t=w.value===a?1:-1;W.value=t,a===w.value?w.value=void 0:w.value=a;const l=n.map((o,u)=>[u,o]).sort((o,u)=>t*(u[1]-o[1])).map(o=>o[0]).map(o=>y.value[o]);k.value=l,_.value+=1}const se=m(()=>Math.max(...b.dataset.map(a=>(a.values||[]).length))),x=m(()=>{let a=e.value.colNames;if(!a.length)for(let t=0;t<se.value;t+=1)a.push(`col ${t+1}`);e.value.showTotal&&(a=[...a,e.value.translations.total]);let n;return e.value.showAverage&&e.value.showMedian?n=[...a,e.value.translations.average,e.value.translations.median]:e.value.showAverage&&!e.value.showMedian?n=[...a,e.value.translations.average]:!e.value.showAverage&&e.value.showMedian?n=[...a,e.value.translations.median]:n=a,e.value.showSparklines?[...n,e.value.translations.chart]:n}),g=v(void 0),h=v(void 0);function ie({dataIndex:a,serieIndex:n}){g.value=a,h.value=n}const U=v(!1);function re(a){U.value=a,E.value+=1}function H(){ge(()=>{const a=[e.value.translations.serie].concat(x.value),n=D.value.map((o,u)=>[[o.name],o.values,[o.sum],[o.average],[o.median]]),t=[a].concat(n),l=Ie(t);Ae({csvContent:l,title:e.value.title.text||"vue-ui-table-sparkline"})})}return Q({generatePdf:j,generateImage:q,generateCsv:H,restoreOrder:ne}),(a,n)=>(s(),d("div",{ref_key:"tableContainer",ref:C,class:M({"vue-ui-responsive":L.value}),style:{overflow:"hidden"},id:`table_${P.value}`},[c("div",{style:{overflow:"auto"},onPointerleave:n[0]||(n[0]=t=>{h.value=void 0,g.value=void 0})},[c("table",{class:"vue-ui-data-table",style:i({fontFamily:e.value.fontFamily,position:"relative"})},[e.value.title.text?(s(),d("caption",{key:0,style:i({backgroundColor:e.value.title.backgroundColor})},[c("div",{style:i({fontSize:`${e.value.title.fontSize}px`,fontWeight:e.value.title.bold?"bold":"normal",color:e.value.title.color,textAlign:e.value.title.textAlign})},p(e.value.title.text),5),e.value.title.subtitle.text?(s(),d("div",{key:0,style:i({fontSize:`${e.value.title.subtitle.fontSize}px`,fontWeight:e.value.title.subtitle.bold?"bold":"normal",color:e.value.title.subtitle.color,textAlign:e.value.title.textAlign})},p(e.value.title.subtitle.text),5)):f("",!0)],4)):f("",!0),c("thead",We,[c("tr",{role:"row",class:"vue-ui-data-table__thead-row",style:i({backgroundColor:e.value.thead.backgroundColor,color:e.value.thead.color})},[c("th",{role:"cell",style:i({backgroundColor:e.value.thead.backgroundColor,outline:e.value.thead.outline,textAlign:e.value.thead.textAlign,fontWeight:e.value.thead.bold?"bold":"normal"}),class:"sticky-col-first"},p(e.value.translations.serie),5),(s(!0),d(O,null,G(x.value,(t,l)=>(s(),d("th",{role:"cell",style:i({background:e.value.thead.backgroundColor,outline:e.value.thead.outline,textAlign:e.value.thead.textAlign,fontWeight:e.value.thead.bold?"bold":"normal",minWidth:l===x.value.length-1?"150px":"",cursor:y.value[0].values[l]!==void 0?"pointer":"default"}),onClick:()=>ue(l),class:M({"sticky-col":l===x.value.length-1&&e.value.showSparklines})},[c("div",Ge,[c("span",null,p(t),1),F.value&&l===N.value&&y.value[0].values[l]!==void 0?(s(),T(ze,{key:0,size:18,name:W.value===1?"sort":"sortReverse",stroke:e.value.thead.color},null,8,["name","stroke"])):f("",!0)]),e.value.userOptions.show&&l===x.value.length-1?(s(),T(Fe,{ref_for:!0,ref:"details",key:`user_option_${E.value}`,backgroundColor:e.value.thead.backgroundColor,color:e.value.thead.color,isPrinting:r(B),isImaging:r(V),uid:P.value,hasPdf:e.value.userOptions.buttons.pdf,hasXls:e.value.userOptions.buttons.csv,hasImg:e.value.userOptions.buttons.img,hasFullscreen:e.value.userOptions.buttons.fullscreen,isFullscreen:U.value,titles:{...e.value.userOptions.buttonTitles},chartElement:C.value,position:e.value.userOptions.position,onToggleFullscreen:re,onGeneratePdf:r(j),onGenerateImage:r(q),onGenerateCsv:H},ce({_:2},[a.$slots.optionPdf?{name:"optionPdf",fn:I(()=>[A(a.$slots,"optionPdf",{},void 0,!0)]),key:"0"}:void 0,a.$slots.optionCsv?{name:"optionCsv",fn:I(()=>[A(a.$slots,"optionCsv",{},void 0,!0)]),key:"1"}:void 0,a.$slots.optionImg?{name:"optionImg",fn:I(()=>[A(a.$slots,"optionImg",{},void 0,!0)]),key:"2"}:void 0,a.$slots.optionFullscreen?{name:"optionFullscreen",fn:I(({toggleFullscreen:o,isFullscreen:u})=>[A(a.$slots,"optionFullscreen",pe(be({toggleFullscreen:o,isFullscreen:u})),void 0,!0)]),key:"3"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasXls","hasImg","hasFullscreen","isFullscreen","titles","chartElement","position","onGeneratePdf","onGenerateImage"])):f("",!0)],14,Oe))),256))],4)]),c("tbody",null,[(s(!0),d(O,null,G(k.value,(t,l)=>(s(),d("tr",{role:"row",style:i({backgroundColor:e.value.tbody.backgroundColor,color:e.value.tbody.color}),class:M({"vue-ui-data-table__tbody__row":!0,"vue-ui-data-table__tbody__row-even":l%2===0,"vue-ui-data-table__tbody__row-odd":l%2!==0})},[c("td",{role:"cell",style:i({backgroundColor:e.value.tbody.backgroundColor,outline:e.value.tbody.outline,fontSize:`${e.value.tbody.fontSize}px`,fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign}),"data-cell":e.value.translations.serie,class:"vue-ui-data-table__tbody__td sticky-col-first"},[c("div",Te,[c("span",{style:i({color:t.color})},"â¬¤",4),c("span",null,p(t.name??"-"),1)])],12,Me),(s(!0),d(O,null,G(oe.value,(o,u)=>(s(),d("td",{dir:"auto",role:"cell",style:i({outline:e.value.tbody.outline,fontSize:`${e.value.tbody.fontSize}px`,fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign,backgroundColor:g.value!==void 0&&h.value!==void 0&&u===g.value&&h.value===l?`${t.color}33`:"",borderRadius:g.value!==void 0&&h.value!==void 0&&u===g.value&&h.value===l?"3px":""}),"data-cell":x.value[u],class:"vue-ui-data-table__tbody__td",onPointerenter:Le=>{h.value=l,g.value=u}},p([null,void 0].includes(t.values[u])?"-":r(S)(e.value.formatter,Number(t.values[u]),r(z)({p:e.value.prefix,v:Number(t.values[u]),s:e.value.suffix,r:e.value.roundingValues}),{datapoint:t,seriesIndex:l,datapointIndex:u})),45,Ee))),256)),e.value.showTotal?(s(),d("td",{key:0,dir:"auto",role:"cell",style:i({outline:e.value.tbody.outline,fontSize:`${e.value.tbody.fontSize}px`,fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign}),"data-cell":e.value.translations.total,class:"vue-ui-data-table__tbody__td"},p(r(S)(e.value.formatter,t.sum,r(z)({p:e.value.prefix,v:t.sum,s:e.value.suffix,r:e.value.roundingTotal}),{datapoint:t.sum,seriesIndex:l})),13,Re)):f("",!0),e.value.showAverage?(s(),d("td",{key:1,dir:"auto",role:"cell",style:i({outline:e.value.tbody.outline,fontSize:`${e.value.tbody.fontSize}px`,fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign}),"data-cell":e.value.translations.average,class:"vue-ui-data-table__tbody__td"},p(r(S)(e.value.formatter,t.average,r(z)({p:e.value.prefix,v:t.average,s:e.value.suffix,r:e.value.roundingAverage}),{datapoint:t.average,seriesIndex:l})),13,Be)):f("",!0),e.value.showMedian?(s(),d("td",{key:2,dir:"auto",role:"cell",style:i({outline:e.value.tbody.outline,fontSize:`${e.value.tbody.fontSize}px`,fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign}),"data-cell":e.value.translations.median,class:"vue-ui-data-table__tbody__td"},p(r(S)(e.value.formatter,t.median,r(z)({p:e.value.prefix,v:t.median,s:e.value.suffix,r:e.value.roundingMedian}),{datapoint:t.median,seriesIndex:l})),13,Ve)):f("",!0),e.value.showSparklines?(s(),d("td",{key:3,role:"cell","data-cell":e.value.translations.chart,style:i({outline:e.value.tbody.outline,fontSize:`${e.value.tbody.fontSize}px`,fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign}),class:"vue-ui-data-table__tbody__td sticky-col"},[(s(),T($e,{key:`sparkline_${l}_${_.value}`,onHoverIndex:({index:o})=>ie({dataIndex:o,serieIndex:l}),dataset:t.sparklineDataset,showInfo:!1,selectedIndex:g.value,config:{type:e.value.sparkline.type,style:{backgroundColor:e.value.tbody.backgroundColor,animation:{show:e.value.sparkline.animation.show&&!r(B)&&!r(V),animationFrames:e.value.sparkline.animation.animationFrames},line:{color:t.color,smooth:e.value.sparkline.smooth,strokeWidth:e.value.sparkline.strokeWidth},bar:{color:t.color},area:{color:t.color,opacity:e.value.sparkline.showArea?16:0,useGradient:e.value.sparkline.useGradient},verticalIndicator:{color:t.color},plot:{radius:9,stroke:e.value.tbody.backgroundColor,strokeWidth:3}}}},null,8,["onHoverIndex","dataset","selectedIndex","config"]))],12,je)):f("",!0)],6))),256))])],4)],32)],10,Ne))}},ea=Se(qe,[["__scopeId","data-v-26b54f10"]]);export{ea as default};
