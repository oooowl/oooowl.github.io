import{ar as J,p as h,h as d,q as Y,v as Q,o,c as n,b as Z,aj as ee,w as x,r,ak as c,al as g,k as f,e as m,j as y,N as $,F as k,C as I,G as ae,K as T,n as M,P as le}from"./framework.BaNfDZ-f.js";import{o as te,L as S,G as se,X as oe,K as ne,_ as re,x as ie,U as ue,N as ve,O as de}from"../chart.md.hi_nZSnT.js";import{c as B}from"./useNestedProp-S1UXxUgm.CErBICdk.js";import{s as ce,i as pe}from"./usePrinter-8ofTb2MJ.pt_J2AaR.js";import{$ as me}from"./Shape-CO_Ak9Zm.UkrUmJI7.js";import{s as ge}from"./vue-data-ui-Cp7bO_tj.DKBrIOIj.js";const he=["id"],fe={role:"cell"},ye={role:"row"},be=["data-cell"],xe={key:0,style:{display:"flex","flex-direction":"row",gap:"2px","align-items":"center"}},ke=["height","width"],we={key:0,role:"cell","data-cell":"sum"},Ce={key:1,role:"cell","data-cell":"average"},$e={key:2,role:"cell","data-cell":"median"},Ie={__name:"vue-ui-table-heatmap",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},setup(E,{expose:X}){const p=E;J(e=>({"67436fce":W.value,"0c1550ae":H.value}));const{vue_ui_table_heatmap:L}=te(),w=h(S()),i=h(!1),b=h(null),C=h(!1),_=h(0),a=d({get:()=>P(),set:e=>e});function P(){const e=B({userConfig:p.config,defaultConfig:L});return e.theme?{...B({userConfig:se.vue_ui_table_heatmap[e.theme]||p.config,defaultConfig:e})}:e}Y(()=>p.config,e=>{a.value=P(),O()},{deep:!0});const{isPrinting:j,isImaging:A,generatePdf:F,generateImage:N}=ce({elementId:`table_heatmap_${w.value}`,fileName:"vue-ui-table-heatmap"}),K=d(()=>a.value.table.responsiveBreakpoint),U=d(()=>!!p.dataset&&p.dataset.length);Q(()=>{O()});function O(){oe(p.dataset)&&ne({componentName:"VueUiTableHeatmap",type:"dataset"});const e=new ResizeObserver(s=>{s.forEach(l=>{i.value=l.contentRect.width<K.value})});b.value&&e.observe(b.value)}const R=d(()=>p.dataset.map(e=>{const s=e.values.map(t=>isNaN(t)?0:t),l=s.reduce((t,v)=>t+v,0);return{...e,values:s,serieExtremes:{max:Math.max(...s),min:Math.min(...s)},sum:l,average:l/s.length,median:re(s),displayValues:[e.name,...e.values],id:S()}})),V=d(()=>{const e=R.value.flatMap(s=>s.values);return{min:Math.min(...e),max:Math.max(...e)}});function q(e,s){const l=a.value.style.heatmapColors.useIndividualScale;return ue(a.value.style.heatmapColors.min,a.value.style.heatmapColors.max,l?s.min:V.value.min,l?s.max:V.value.max,e)}const z=d(()=>R.value.map(e=>({...e,colors:e.displayValues.map(s=>isNaN(s)?a.value.style.backgroundColor:q(s,e.serieExtremes))}))),H=d(()=>a.value.style.backgroundColor),W=d(()=>`${a.value.table.borderWidth}px`);function G(){le(()=>{const e=z.value.map(t=>[[t.name],t.displayValues,[t.sum],[t.average],[t.median]]),s=[[[""],a.value.table.head.values,["sum"],["average"],["median"]]].concat(e),l=ve(s);de({csvContent:l,title:"vue-ui-table-heatmap"})})}function D(e){C.value=e,_.value+=1}return X({generatePdf:F,generateCsv:G,generateImage:N}),(e,s)=>(o(),n("div",{ref_key:"tableContainer",ref:b,style:$(`width:100%; overflow-x:auto; container-type: inline-size;padding-top:${a.value.userOptions.show?"36px":""}; ${C.value?"vue-data-ui-wrapper-fullscreen":""}; position:relative;`),class:M({"vue-ui-responsive":i.value}),id:`table_heatmap_${w.value}`},[a.value.userOptions.show&&U.value?(o(),Z(pe,{ref:"details",key:`user_option_${_.value}`,backgroundColor:a.value.style.backgroundColor,color:a.value.style.color,isPrinting:f(j),isImaging:f(A),uid:w.value,hasPdf:a.value.userOptions.buttons.pdf,hasXls:a.value.userOptions.buttons.csv,hasImg:a.value.userOptions.buttons.img,hasFullscreen:a.value.userOptions.buttons.fullscreen,isFullscreen:C.value,titles:{...a.value.userOptions.buttonTitles},chartElement:b.value,position:a.value.userOptions.position,onToggleFullscreen:D,onGeneratePdf:f(F),onGenerateCsv:G,onGenerateImage:f(N)},ee({_:2},[e.$slots.optionPdf?{name:"optionPdf",fn:x(()=>[r(e.$slots,"optionPdf",{},void 0,!0)]),key:"0"}:void 0,e.$slots.optionCsv?{name:"optionCsv",fn:x(()=>[r(e.$slots,"optionCsv",{},void 0,!0)]),key:"1"}:void 0,e.$slots.optionImg?{name:"optionImg",fn:x(()=>[r(e.$slots,"optionImg",{},void 0,!0)]),key:"2"}:void 0,e.$slots.optionFullscreen?{name:"optionFullscreen",fn:x(({toggleFullscreen:l,isFullscreen:t})=>[r(e.$slots,"optionFullscreen",c(g({toggleFullscreen:l,isFullscreen:t})),void 0,!0)]),key:"3"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasXls","hasImg","hasFullscreen","isFullscreen","titles","chartElement","position","onGeneratePdf","onGenerateImage"])):m("",!0),y("table",{class:M({"vue-ui-table-heatmap":!0}),style:$(`width:100%;font-family:${a.value.style.fontFamily};background:${a.value.style.backgroundColor};`)},[y("caption",null,[r(e.$slots,"caption",{},void 0,!0)]),y("thead",null,[y("tr",{role:"row",style:$(`background:${a.value.table.head.backgroundColor};color:${a.value.table.head.color}`)},[(o(!0),n(k,null,I(a.value.table.head.values,(l,t)=>(o(),n("th",fe,[r(e.$slots,"head",c(g({value:l,rowIndex:t,type:typeof l,isResponsive:i.value})),void 0,!0)]))),256))],4)]),y("tbody",null,[(o(!0),n(k,null,I(z.value,(l,t)=>(o(),n("tr",ye,[(o(!0),n(k,null,I(l.displayValues,(v,u)=>(o(),n("td",{role:"cell","data-cell":a.value.table.head.values[u]},[l.color&&u===0?(o(),n("div",xe,[l.color?(o(),n("svg",{key:0,height:a.value.style.shapeSize,width:a.value.style.shapeSize,viewBox:"0 0 20 20",style:{background:"none",overflow:"visible"}},[ae(me,{plot:{x:10,y:10},color:l.color,radius:9,shape:l.shape||"circle"},null,8,["color","shape"])],8,ke)):m("",!0),r(e.$slots,"rowTitle",c(g({value:v,rowIndex:t,colIndex:u,type:typeof v,isResponsive:i.value})),void 0,!0)])):(o(),n(k,{key:1},[u===0?r(e.$slots,"rowTitle",c(T({key:0},{value:v,rowIndex:t,colIndex:u,type:typeof v,isResponsive:i.value})),void 0,!0):m("",!0),u>0?r(e.$slots,"cell",c(T({key:1},{value:v,rowIndex:t,colIndex:u,type:typeof v,isResponsive:i.value,color:l.colors[u],textColor:f(ie)(l.colors[u])})),void 0,!0):m("",!0)],64))],8,be))),256)),a.value.table.showSum?(o(),n("td",we,[r(e.$slots,"sum",c(g({value:l.sum,rowIndex:t,isResponsive:i.value})),void 0,!0)])):m("",!0),a.value.table.showAverage?(o(),n("td",Ce,[r(e.$slots,"average",c(g({value:l.average,rowIndex:t,isResponsive:i.value})),void 0,!0)])):m("",!0),a.value.table.showMedian?(o(),n("td",$e,[r(e.$slots,"median",c(g({value:l.median,rowIndex:t,isResponsive:i.value})),void 0,!0)])):m("",!0)]))),256))])],4)],14,he))}},Ve=ge(Ie,[["__scopeId","data-v-2bd72dde"]]);export{Ve as default};
