import{h as p,p as r,q as Z,v as Ae,Y as Re,o as i,c as m,b as M,e as z,aj as Ee,w as d,r as h,ak as A,al as R,k,n as me,G as ee,j as C,F as Ge,C as Ve,N as te,t as pe,a as Be,P as ge,ar as We,am as je,an as He}from"./framework.BaNfDZ-f.js";import{o as Xe,J as qe,k as De,L as fe,G as Le,R as Ue,e as X,X as Ye,K as ye,q as Ke,b as Qe,Q as Je,N as Ze,O as et,H as tt}from"../chart.md.hi_nZSnT.js";import{x as ot}from"./Title-DYNLqCCT.D6xZGHSM.js";import{s as at,i as lt}from"./usePrinter-8ofTb2MJ.pt_J2AaR.js";import{E as st,O as rt,M as ut}from"./useResponsive-NZB-WLRF.DbXjWqi_.js";import nt from"./vue-ui-accordion-D_1fE5EF.ggAyum2g.js";import{W as it}from"./DataTable-DL2agEJ3.DwhyhpBD.js";import{s as we,u as ct}from"./vue-data-ui-Cp7bO_tj.DKBrIOIj.js";import{c as be}from"./useNestedProp-S1UXxUgm.CErBICdk.js";import{p as vt}from"./PackageVersion-DtnhR89q.DeJ10Meb.js";import{E as dt}from"./Tooltip-CICAYyQj.DC7pN5Ho.js";import"./Shape-CO_Ak9Zm.UkrUmJI7.js";const ht=c=>(je("data-v-3fd7d274"),c=c(),He(),c),mt={"data-html2canvas-ignore":""},pt={key:0,class:"reset-wrapper"},gt={key:1,class:"reset-wrapper"},ft={class:"mono-slicer"},yt=ht(()=>C("div",{class:"slider-track"},null,-1)),bt=["min","max","value"],wt={__name:"MonoSlicer",props:{min:{type:Number,default:0},max:{type:Number,default:0},inputColor:{type:String,default:"#1A1A1A"},background:{type:String,default:"#FFFFFF"},borderColor:{type:String,default:"#FFFFFF"},selectColor:{type:String,default:"#4A4A4A"},textColor:{type:String,default:"#1A1A1A"},useResetSlot:{type:Boolean,default:!1},value:{type:Number,default:0},source:{type:Number,default:0}},emits:["update:value","reset"],setup(c,{emit:E}){const s=c;We(x=>({"90ad3208":q.value,"4f9eef70":N.value,"6e07ae3e":b.value,"2fd430a0":c.selectColor,"6b8169a4":$.value}));const q=p(()=>s.inputColor),$=p(()=>s.background),b=p(()=>`${s.selectColor}33`),N=p(()=>s.borderColor);function P(){E("reset")}const w=p(()=>{const x=s.max-s.min,f=0,F=(s.value-s.min)/x*100;return{left:`${f}%`,width:`${F-f}%`,background:s.selectColor}});return(x,f)=>(i(),m("div",mt,[c.value!==c.source?(i(),m("div",pt,[c.useResetSlot?h(x.$slots,"reset-action",{key:1,reset:P},void 0,!0):(i(),m("button",{key:0,"data-cy-reset":"",tabindex:"0",role:"button",class:"vue-data-ui-refresh-button",onClick:P},[ee(ct,{name:"refresh",stroke:c.textColor},null,8,["stroke"])]))])):(i(),m("div",gt)),C("div",ft,[yt,C("div",{class:"range-highlight",style:te(w.value)},null,4),C("input",{type:"range",min:c.min,max:c.max,value:Number(c.value),onInput:f[0]||(f[0]=F=>E("update:value",Number(F.target.value)))},null,40,bt)])]))}},xt=we(wt,[["__scopeId","data-v-3fd7d274"]]),kt=["id"],Ct=["xmlns","viewBox"],$t=["transform"],Ft=["fill","font-weight","x","y","font-size","transform","onMouseover"],St={key:3,class:"vue-data-ui-watermark"},Tt=["innerHTML"],_t={__name:"vue-ui-word-cloud",props:{config:{type:Object,default(){return{}}},dataset:{type:[Array,String],default(){return[]}}},setup(c,{expose:E}){const s=c,{vue_ui_word_cloud:q}=Xe(),$=p({get(){return!!s.dataset&&s.dataset.length},set(t){return t}}),b=r(typeof s.dataset=="string"?qe(s.dataset):s.dataset.map(t=>({...t,value:De(t.value)}))),N=r(fe()),P=r(0),w=r(null),x=r(null),f=r(0),F=r(0),D=r(!1),e=p({get:()=>oe(),set:t=>t});function oe(){const t=be({userConfig:s.config,defaultConfig:q});return t.theme?{...be({userConfig:Le.vue_ui_word_cloud[t.theme]||s.config,defaultConfig:t}),customPalette:Ue[t.theme]||X}:t}Z(()=>s.config,t=>{e.value=oe(),le(),f.value+=1,F.value+=1,L()},{deep:!0});const ae=r(null),S=r(0),n=r({width:e.value.style.chart.width,height:e.value.style.chart.height,maxFontSize:e.value.style.chart.words.maxFontSize,minFontSize:e.value.style.chart.words.minFontSize}),xe=rt(()=>{const{width:t,height:a}=ut({chart:w.value,title:e.value.style.chart.title.text?x.value:null,slicer:e.value.style.chart.zoom.show&&ae.value});n.value.width=t,n.value.height=a,ge(U)});Z(()=>S.value,()=>{ke()});const ke=st(()=>{U()},10);function L(){S.value=ie.value}const G=r(null);Ae(()=>{le(),L()});function le(){Ye(s.dataset)?ye({componentName:"VueUiWordCloud",type:"dataset"}):b.value.forEach((t,a)=>{Ke({datasetObject:t,requiredAttributes:["name","value"]}).forEach(o=>{$.value=!1,ye({componentName:"VueUiWordCloud",type:"datasetSerieAttribute",property:o,index:a})})}),e.value.responsive&&(G.value=new ResizeObserver(xe),G.value.observe(w.value.parentNode))}Re(()=>{G.value&&G.value.disconnect()});const{isPrinting:se,isImaging:re,generatePdf:ue,generateImage:ne}=at({elementId:`wordCloud_${N.value}`,fileName:e.value.style.chart.title.text||"vue-ui-word-cloud"}),v=r({showTable:e.value.table.show,showTooltip:e.value.style.chart.tooltip.show});function Ce(t,a,o="Arial"){const u=document.createElement("canvas").getContext("2d");return u.font=`${a}px ${e.value.style.chart.words.bold?"bold":"normal"} ${o}`,{width:u.measureText(t).width+e.value.style.chart.words.proximity,height:a}}function $e(t,a){return t.x<a.x+a.width&&t.x+t.width>a.x&&t.y<a.y+a.height&&t.y+t.height>a.y}function Fe(t,a,o){const u=[],l={x:-a/2,y:-o/2,width:a,height:o},g=0,j=0;return t.forEach(_=>{let Q=!1;for(let H=0;H<Math.max(a,o)/2&&!Q;H+=e.value.style.chart.words.packingWeight)for(let J=0;J<360&&!Q;J+=e.value.style.chart.words.packingWeight){const he=J*Math.PI/180,Ne=g+H*Math.cos(he)-_.width/2,Pe=j+H*Math.sin(he)-_.height/2,y={..._,x:Ne,y:Pe},Ie=y.x>=l.x&&y.y>=l.y&&y.x+y.width<=l.x+l.width&&y.y+y.height<=l.y+l.height,Oe=u.some(Me=>$e(y,Me));Ie&&!Oe&&(u.push(y),Q=!0)}}),u}const I=r([]);Z(()=>s.dataset,U,{immediate:!0});const ie=p(()=>Math.min(...b.value.map(t=>t.value))),Se=p(()=>Math.max(...b.value.map(t=>t.value)));function U(){const t=[...b.value].filter(l=>l.value>=S.value).map(l=>l.value),a=Math.max(...t),o=Math.min(...t),u=[...b.value].filter(l=>l.value>=S.value).map((l,g)=>{const j=(l.value-o)/(a-o)*(n.value.maxFontSize-n.value.minFontSize)+n.value.minFontSize,_=Ce(l.name,j);return{...l,id:fe(),fontSize:j,width:_.width,height:_.height,color:e.value.style.chart.words.usePalette?e.value.customPalette[g]||e.value.customPalette[g%e.value.customPalette.length]||X[g]||X[g%X.length]:e.value.style.chart.words.color}});I.value=Fe(u,n.value.width,n.value.height).sort((l,g)=>g.fontSize-l.fontSize)}const V=p(()=>{const t=I.value.map(o=>({name:o.name,color:o.color})),a=I.value.map(o=>o.value);return{head:t,body:a}});function ce(){ge(()=>{const t=V.value.head.map((u,l)=>[[u.name],[V.value.body[l]]]),a=[[e.value.style.chart.title.text],[e.value.style.chart.title.subtitle.text],[[""],[e.value.table.columnNames.value]]].concat(t),o=Ze(a);et({csvContent:o,title:e.value.style.chart.title.text||"vue-ui-word-cloud"})})}const B=p(()=>{const t=[e.value.table.columnNames.series,e.value.table.columnNames.value],a=V.value.head.map((u,l)=>{const g=Qe({p:e.value.table.td.prefix,v:V.value.body[l],s:e.value.table.td.suffix,r:e.value.table.td.roundingValue});return[{color:u.color,name:u.name},g]}),o={th:{backgroundColor:e.value.table.th.backgroundColor,color:e.value.table.th.color,outline:e.value.table.th.outline},td:{backgroundColor:e.value.table.td.backgroundColor,color:e.value.table.td.color,outline:e.value.table.td.outline},breakpoint:e.value.table.responsiveBreakpoint};return{colNames:[e.value.table.columnNames.series,e.value.table.columnNames.value],head:t,body:a,config:o}}),W=r(!1);function Te(t){W.value=t,P.value+=1}function _e(){return I.value}function ve(){v.value.showTable=!v.value.showTable}function de(){v.value.showTooltip=!v.value.showTooltip}E({getData:_e,generateCsv:ce,generatePdf:ue,generateImage:ne,toggleTable:ve,toggleTooltip:de});const T=r(null),O=r(!1),Y=r(""),K=r(null);function ze(t){if(!v.value.showTooltip)return;T.value=t.id,K.value={datapoint:t,config:e.value};const a=e.value.style.chart.tooltip.customFormat;if(O.value=!1,tt(a))try{const o=a({datapoint:t,config:e.value});typeof o=="string"&&(Y.value=o,O.value=!0)}catch{console.warn("Custom format cannot be applied."),O.value=!1}if(!O.value){let o=`<svg viewBox="0 0 10 10" height="${e.value.style.chart.tooltip.fontSize}"><circle cx="5" cy="5" r="5" fill="${t.color}"/></svg><span>${t.name}:</span><b>${(t.value||0).toFixed(e.value.style.chart.tooltip.roundingValue)}</b>`;Y.value=`<div dir="auto" style="display:flex; gap:4px; align-items:center; jsutify-content:center;">${o}</div>`}D.value=!0}return(t,a)=>(i(),m("div",{class:"vue-ui-word-cloud",ref_key:"wordCloudChart",ref:w,id:`wordCloud_${N.value}`,style:te(`width: 100%; font-family:${e.value.style.fontFamily};background:${e.value.style.chart.backgroundColor};${e.value.responsive?"height:100%":""}`)},[e.value.style.chart.title.text?(i(),m("div",{key:0,ref_key:"chartTitle",ref:x,style:"width:100%;background:transparent;padding-bottom:24px"},[(i(),M(ot,{key:`title_${f.value}`,config:{title:{...e.value.style.chart.title},subtitle:{...e.value.style.chart.title.subtitle}}},null,8,["config"]))],512)):z("",!0),e.value.userOptions.show&&$.value?(i(),M(lt,{ref:"details",key:`user_option_${P.value}`,backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color,isPrinting:k(se),isImaging:k(re),uid:N.value,hasPdf:e.value.userOptions.buttons.pdf,hasXls:e.value.userOptions.buttons.csv,hasImg:e.value.userOptions.buttons.img,hasTable:e.value.userOptions.buttons.table,hasFullscreen:e.value.userOptions.buttons.fullscreen,isFullscreen:W.value,titles:{...e.value.userOptions.buttonTitles},chartElement:w.value,position:e.value.userOptions.position,hasTooltip:e.value.style.chart.tooltip.show&&e.value.userOptions.buttons.tooltip,isTooltip:v.value.showTooltip,onToggleFullscreen:Te,onGeneratePdf:k(ue),onGenerateCsv:ce,onGenerateImage:k(ne),onToggleTable:ve,onToggleTooltip:de},Ee({_:2},[t.$slots.optionPdf?{name:"optionPdf",fn:d(()=>[h(t.$slots,"optionPdf",{},void 0,!0)]),key:"0"}:void 0,t.$slots.optionCsv?{name:"optionCsv",fn:d(()=>[h(t.$slots,"optionCsv",{},void 0,!0)]),key:"1"}:void 0,t.$slots.optionImg?{name:"optionImg",fn:d(()=>[h(t.$slots,"optionImg",{},void 0,!0)]),key:"2"}:void 0,t.$slots.optionTable?{name:"optionTable",fn:d(()=>[h(t.$slots,"optionTable",{},void 0,!0)]),key:"3"}:void 0,t.$slots.optionFullscreen?{name:"optionFullscreen",fn:d(({toggleFullscreen:o,isFullscreen:u})=>[h(t.$slots,"optionFullscreen",A(R({toggleFullscreen:o,isFullscreen:u})),void 0,!0)]),key:"4"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasXls","hasImg","hasTable","hasFullscreen","isFullscreen","titles","chartElement","position","hasTooltip","isTooltip","onGeneratePdf","onGenerateImage"])):z("",!0),$.value?(i(),m("svg",{key:2,class:me({"vue-data-ui-fullscreen--on":W.value,"vue-data-ui-fulscreen--off":!W.value}),xmlns:k(Je),viewBox:`0 0 ${n.value.width<=0?10:n.value.width} ${n.value.height<=0?10:n.value.height}`,style:"overflow:visible;background:transparent;"},[ee(vt),C("g",{transform:`translate(${(n.value.width<=0?10:n.value.width)/2}, ${(n.value.height<=0?10:n.value.height)/2})`},[(i(!0),m(Ge,null,Ve(I.value,(o,u)=>(i(),m("g",null,[(i(),m("text",{fill:o.color,"font-weight":e.value.style.chart.words.bold?"bold":"normal",key:u,x:o.x,y:o.y,"font-size":o.fontSize,transform:`translate(${o.width/2}, ${o.height/2})`,class:me({animated:e.value.useCssAnimation,"word-selected":T.value&&T.value===o.id&&v.value.showTooltip,"word-not-selected":T.value&&T.value!==o.id&&v.value.showTooltip}),"text-anchor":"middle","dominant-baseline":"middle",onMouseover:l=>ze(o),onMouseleave:a[0]||(a[0]=l=>{T.value=null,D.value=!1}),style:te(`animation-delay:${u*e.value.animationDelayMs}ms !important;`)},pe(o.name),47,Ft))]))),256))],8,$t),h(t.$slots,"svg",{svg:{height:n.value.height,width:n.value.width}},void 0,!0)],10,Ct)):z("",!0),t.$slots.watermark?(i(),m("div",St,[h(t.$slots,"watermark",A(R({isPrinting:k(se)||k(re)})),void 0,!0)])):z("",!0),ee(dt,{show:v.value.showTooltip&&D.value,backgroundColor:e.value.style.chart.tooltip.backgroundColor,color:e.value.style.chart.tooltip.color,fontSize:e.value.style.chart.tooltip.fontSize,borderRadius:e.value.style.chart.tooltip.borderRadius,borderColor:e.value.style.chart.tooltip.borderColor,borderWidth:e.value.style.chart.tooltip.borderWidth,backgroundOpacity:e.value.style.chart.tooltip.backgroundOpacity,position:e.value.style.chart.tooltip.position,offsetY:e.value.style.chart.tooltip.offsetY,parent:w.value,content:Y.value,isCustom:O.value},{"tooltip-before":d(()=>[h(t.$slots,"tooltip-before",A(R({...K.value})),void 0,!0)]),"tooltip-after":d(()=>[h(t.$slots,"tooltip-after",A(R({...K.value})),void 0,!0)]),_:3},8,["show","backgroundColor","color","fontSize","borderRadius","borderColor","borderWidth","backgroundOpacity","position","offsetY","parent","content","isCustom"]),C("div",{ref_key:"chartSlicer",ref:ae,style:"width:100%;background:transparent","data-html2canvas-ignore":""},[e.value.style.chart.zoom.show?(i(),M(xt,{key:0,value:S.value,"onUpdate:value":a[1]||(a[1]=o=>S.value=o),min:ie.value,max:Se.value,textColor:e.value.style.chart.color,inputColor:e.value.style.chart.zoom.color,selectColor:e.value.style.chart.zoom.highlightColor,useResetSlot:e.value.style.chart.zoom.useResetSlot,background:e.value.style.chart.zoom.color,borderColor:e.value.style.chart.backgroundColor,source:e.value.style.chart.width,onReset:L},{"reset-action":d(({reset:o})=>[h(t.$slots,"reset-action",A(R({reset:o})),void 0,!0)]),_:3},8,["value","min","max","textColor","inputColor","selectColor","useResetSlot","background","borderColor","source"])):z("",!0)],512),$.value?(i(),M(nt,{key:4,hideDetails:"",config:{open:v.value.showTable,maxHeight:1e4,body:{backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color},head:{backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color}}},{content:d(()=>[(i(),M(it,{key:`table_${F.value}`,colNames:B.value.colNames,head:B.value.head,body:B.value.body,config:B.value.config,title:`${e.value.style.chart.title.text}${e.value.style.chart.title.subtitle.text?` : ${e.value.style.chart.title.subtitle.text}`:""}`,onClose:a[2]||(a[2]=o=>v.value.showTable=!1)},{th:d(({th:o})=>[C("div",{innerHTML:o,style:{display:"flex","align-items":"center"}},null,8,Tt)]),td:d(({td:o})=>[Be(pe(o.name||o),1)]),_:1},8,["colNames","head","body","config","title"]))]),_:1},8,["config"])):z("",!0)],12,kt))}},Wt=we(_t,[["__scopeId","data-v-7f4cd511"]]);export{Wt as default};
